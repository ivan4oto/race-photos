<section class="signin-page">
  <div class="container">
    <div class="intro">
      <h1>Sign in</h1>
      <p>Use your Race Photos account or continue with Google.</p>
    </div>

    <amplify-authenticator [formFields]="formFields" [loginMechanisms]="['email']" [socialProviders]="['google']">
      <ng-template amplifySlot="header">
        <div class="auth-card-header">
          <h2>Welcome back</h2>
          <p>We will keep you signed in with a secure backend session.</p>
        </div>
      </ng-template>

      <ng-template amplifySlot="authenticated" let-user="user">
        <div class="post-login">
          <p class="greeting">
            Signed in as
            <strong>
              {{
                authSession.user()?.givenName
                  ? (authSession.user()?.givenName + ' ' + (authSession.user()?.familyName || ''))
                  : authSession.user()?.email
              }}
            </strong>
          </p>
          <p *ngIf="authSession.status() === 'linking'" class="status">
            Finishing secure session setupâ€¦
          </p>
          <p *ngIf="authSession.status() === 'idle' && authSession.user()" class="status success">
            All set! Your backend session is ready.
          </p>
          <p *ngIf="authSession.status() === 'error'" class="status error">
            We could not connect to the backend. Please refresh and try again.
          </p>
          <button type="button" class="btn primary" (click)="continueToApp()" [disabled]="authSession.status() !== 'idle'">
            Continue to app
          </button>
        </div>
      </ng-template>
    </amplify-authenticator>

    <p class="cookie-note">
      After Cognito signs you in we exchange tokens for a secure HttpOnly cookie.
    </p>
  </div>
</section>
